{% extends "default.html" %}
{% block title %}List of messages{% end %}
{% block content %}

  <div class="layout">

    <a class="pure-button" href="/messages/add?{% if item is not None %}&amp;item={{ item }}{% end %}{% if origin is not None %}&amp;origin={{ url_escape(origin) }}{% end %}{% if host is not None %}&amp;host={{ host }}{% end %}">Add Message</a>

{% if len(items) != 0 %}
<table>
  <thead>
    <th>
      Name
    </th>
    <th>
      Host
    </th>
    <th>
    </th>
  </thead>
  <tbody>
{% for row in items %}
  <tr>
    <td>
        {% if 'name' in row %}{{ row['name'] }}{% else %}{{ row['_id'] }}{% end %}
    </td>
    <td>
      <a href="/message/{{ row['_id'] }}?{% if origin %}&amp;origin={{ url_escape(origin) }}{% end %}{% if host is not None %}&amp;host={{ host }}{% end %}{% if item is not None %}&amp;item={{ item }}{% end %}">
      {{ row['host'] }}
      </a>
    </td>
    <td>
      <form method="post" name="deleteForm">
        <input type="hidden" name="ident" value="{{ row['_id'] }}" />
        <input type="hidden" name="action" value="delete" />
        <button class="btn" name="delete"><i class="fa fa-times"></i></button>
      </form>
    </td>
  </tr>
{% end %}
  </tbody>
</table>
{% end %}

</div>

<script src="/static/jquery.min.js"></script>
<script type="text/javascript">
    $('form[name=deleteForm]').on('submit', function(evt){
      if (!confirm("Are you sure you want to delete this message?")) {
        return false;
      }
    });
</script>
{% end %}
